<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Task Schedule - KARIBU GROCERIES .LTD</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="dashboard-container">
      <div class="sidebar">
        <div class="profile-section">
          <div class="profile-avatar"></div>
          <div class="profile-info">
            <h3 id="profileRole">Guest</h3>
            <p id="profileName">Not logged in</p>
          </div>
        </div>
        <nav class="sidebar-nav">
          <ul class="nav-menu">
            <li class="nav-item">
              <a href="accounts.html" class="nav-link"
                ><span class="nav-icon"></span><span>Accounts</span></a
              >
            </li>
            <li class="nav-item">
              <a href="sales.html" class="nav-link"
                ><span class="nav-icon"></span><span>Sales track</span></a
              >
            </li>
            <li class="nav-item">
              <a href="stock.html" class="nav-link"
                ><span class="nav-icon"></span><span>Stock</span></a
              >
            </li>
            <li class="nav-item">
              <a href="invoices.html" class="nav-link"
                ><span class="nav-icon"></span><span>Invoices</span></a
              >
            </li>
            <li class="nav-item active">
              <a href="tasks.html" class="nav-link"
                ><span class="nav-icon"></span><span>Task schedule</span></a
              >
            </li>
            <li class="nav-item">
              <a href="communication.html" class="nav-link"
                ><span class="nav-icon"></span><span>communication</span></a
              >
            </li>
            <li class="nav-item">
              <a href="users.html" class="nav-link"
                ><span class="nav-icon"></span><span>Users</span></a
              >
            </li>
            <li class="nav-item">
              <a href="reports.html" class="nav-link"
                ><span class="nav-icon"></span><span>Report</span></a
              >
            </li>
            <li class="nav-item">
              <a href="support.html" class="nav-link"
                ><span class="nav-icon"></span><span>Support</span></a
              >
            </li>
          </ul>
        </nav>
      </div>

      <div class="main-content">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h1>Task Schedule</h1>
          <div class="d-flex gap-2">
            <button id="addTaskBtn" class="btn btn-primary" type="button">
              <i class="fas fa-plus"></i> Add Task
            </button>
            <button id="calendarViewBtn" class="btn btn-secondary" type="button">
              <i class="fas fa-calendar"></i> Calendar View
            </button>
            <button class="btn btn-secondary" onclick="handleGlobalLogout(event)" type="button">
              <i class="fas fa-sign-out-alt"></i> Logout
            </button>
          </div>
        </div>

        <div class="row g-3 mb-4">
          <div class="col-md-3">
            <div class="card shadow-sm h-100">
              <div class="card-body d-flex align-items-center">
                <div class="me-3 p-3 bg-primary bg-opacity-10 rounded">
                  <i class="fas fa-tasks fa-2x text-primary"></i>
                </div>
                <div>
                  <h6 class="text-muted mb-1">Total Tasks</h6>
                  <h4 class="mb-0" id="totalTasksCount">0</h4>
                  <small class="text-muted">Live count</small>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="card shadow-sm h-100">
              <div class="card-body d-flex align-items-center">
                <div class="me-3 p-3 bg-success bg-opacity-10 rounded">
                  <i class="fas fa-check-circle fa-2x text-success"></i>
                </div>
                <div>
                  <h6 class="text-muted mb-1">Completed</h6>
                  <h4 class="mb-0" id="completedTasksCount">0</h4>
                  <small class="text-success" id="completedTasksPct">0%</small>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="card shadow-sm h-100">
              <div class="card-body d-flex align-items-center">
                <div class="me-3 p-3 bg-info bg-opacity-10 rounded">
                  <i class="fas fa-clock fa-2x text-info"></i>
                </div>
                <div>
                  <h6 class="text-muted mb-1">In Progress</h6>
                  <h4 class="mb-0" id="inProgressTasksCount">0</h4>
                  <small class="text-muted" id="inProgressTasksPct">0%</small>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="card shadow-sm h-100">
              <div class="card-body d-flex align-items-center">
                <div class="me-3 p-3 bg-warning bg-opacity-10 rounded">
                  <i class="fas fa-exclamation-triangle fa-2x text-warning"></i>
                </div>
                <div>
                  <h6 class="text-muted mb-1">Overdue</h6>
                  <h4 class="mb-0 text-warning" id="overdueTasksCount">0</h4>
                  <small class="text-danger">Auto-updated</small>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Task Form -->
        <div class="card shadow-sm mb-4" id="taskFormSection" style="display: none">
          <div class="card-body">
            <h2 class="card-title mb-4">Add New Task</h2>
            <form id="taskForm">
              <div class="row g-3">
                <div class="col-md-6">
                  <label for="taskTitle" class="form-label">Task Title</label>
                  <input
                    type="text"
                    id="taskTitle"
                    class="form-control"
                    placeholder="Enter task title"
                    required
                  />
                </div>
                <div class="col-md-6">
                  <label for="taskPriority" class="form-label">Priority</label>
                  <select id="taskPriority" class="form-select" required>
                    <option value="low">Low</option>
                    <option value="medium" selected>Medium</option>
                    <option value="high">High</option>
                    <option value="urgent">Urgent</option>
                  </select>
                </div>
              </div>
              <div class="row g-3 mt-2">
                <div class="col-md-6">
                  <label for="assignedTo" class="form-label">Assigned To</label>
                  <select id="assignedTo" class="form-select" required>
                    <option value="Imani Frank">Imani Frank</option>
                    <option value="John Smith">John Smith</option>
                    <option value="Sarah Johnson">Sarah Johnson</option>
                    <option value="Mike Davis">Mike Davis</option>
                  </select>
                </div>
                <div class="col-md-6">
                  <label for="taskCategory" class="form-label">Category</label>
                  <select id="taskCategory" class="form-select" required>
                    <option value="sales">Sales</option>
                    <option value="marketing">Marketing</option>
                    <option value="support">Customer Support</option>
                    <option value="development">Development</option>
                    <option value="admin">Administrative</option>
                  </select>
                </div>
              </div>
              <div class="row g-3 mt-2">
                <div class="col-md-6">
                  <label for="startDate" class="form-label">Start Date</label>
                  <input type="date" id="startDate" class="form-control" required />
                </div>
                <div class="col-md-6">
                  <label for="dueDate" class="form-label">Due Date</label>
                  <input type="date" id="dueDate" class="form-control" required />
                </div>
              </div>
              <div class="mt-3">
                <label for="taskDescription" class="form-label">Description</label>
                <textarea
                  id="taskDescription"
                  class="form-control"
                  rows="3"
                  placeholder="Task details and requirements"
                  required
                ></textarea>
              </div>
              <div class="d-flex gap-2 justify-content-end mt-4">
                <button type="button" id="cancelTaskBtn" class="btn btn-secondary">
                  <i class="fas fa-times"></i> Cancel
                </button>
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-save"></i> Save Task
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- Task List -->
        <div class="card shadow-sm">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-4">
              <h2 class="card-title mb-0">Task List</h2>
              <div class="d-flex gap-2">
                <select id="statusFilter" class="form-select form-select-sm" style="width: auto">
                  <option value="">All Status</option>
                  <option value="pending">Pending</option>
                  <option value="in-progress">In Progress</option>
                  <option value="completed">Completed</option>
                  <option value="overdue">Overdue</option>
                </select>
                <select id="priorityFilter" class="form-select form-select-sm" style="width: auto">
                  <option value="">All Priorities</option>
                  <option value="urgent">Urgent</option>
                  <option value="high">High</option>
                  <option value="medium">Medium</option>
                  <option value="low">Low</option>
                </select>
                <select id="categoryFilter" class="form-select form-select-sm" style="width: auto">
                  <option value="">All Categories</option>
                </select>
                <select id="assigneeFilter" class="form-select form-select-sm" style="width: auto">
                  <option value="">All Assignees</option>
                </select>
                <input
                  type="text"
                  id="searchTasks"
                  class="form-control form-control-sm"
                  placeholder="Search tasks..."
                  style="width: 200px"
                />
              </div>
            </div>
            <div class="table-responsive">
              <table class="table table-hover">
                <thead class="table-light">
                  <tr>
                    <th>Task</th>
                    <th>Assigned To</th>
                    <th>Priority</th>
                    <th>Category</th>
                    <th>Due Date</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="tasksTableBody"></tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="card shadow-sm mt-4">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h2 class="card-title mb-0">Activity Log</h2>
              <span class="text-muted small">Recent task events</span>
            </div>
            <div id="taskActivityLog" class="activity-log"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Calendar Modal -->
    <!-- Calendar Modal - Custom implementation (no Bootstrap modal JS) -->
    <div class="custom-modal-overlay" id="calendarModalOverlay" style="display: none">
      <div class="custom-modal">
        <div class="custom-modal-header">
          <h5>Task Calendar</h5>
          <button type="button" class="custom-modal-close" id="closeCalendarModal">&times;</button>
        </div>
        <div class="custom-modal-body">
          <div id="calendarList" class="calendar-list"></div>
        </div>
        <div class="custom-modal-footer">
          <button type="button" class="btn btn-secondary" id="closeCalendarModalBtn">Close</button>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="utils.js"></script>
    <script src="tasks.js"></script>
    <script src="profile.js"></script>
  </body>
</html>
